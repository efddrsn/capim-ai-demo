# SYSTEM-FLOWS.MD

## Fluxos do Sistema - Demo Capim AI

### Ãšltima AtualizaÃ§Ã£o: 16/01/2025

---

## ğŸ“‹ Resumo das AlteraÃ§Ãµes Recentes

### âœ… ImplementaÃ§Ã£o de Overlay Bubble para Chat

**Data:** 16/01/2025  
**Objetivo:** Melhorar a UX do chat removendo a expansÃ£o que empurrava o conteÃºdo para baixo, substituindo por um overlay bubble flutuante.

#### ğŸ¯ Funcionalidades Implementadas:

1. **Novo Comportamento do Chat**
   - Arquivo: `src/components/ChatOverlay.tsx`
   - Pills de sugestÃ£o desaparecem quando usuÃ¡rio envia mensagem
   - Overlay bubble flutuante aparece ao invÃ©s de expandir a caixa
   - Backdrop semi-transparente com click-to-close
   - Barra de chat principal permanece fixa e nÃ£o empurra conteÃºdo

2. **Design do Overlay com Backdrop**
   - Posicionamento: `fixed` centralizado horizontalmente na tela
   - Container: `w-[600px]` (600px) com altura mÃ¡xima de 75vh
   - Backdrop escuro com blur (`bg-black bg-opacity-20 backdrop-blur-sm`)
   - Mensagens mais largas: `max-w-[480px]` para melhor legibilidade
   - Elementos semi-transparentes com blur (`bg-white/90 backdrop-blur-sm`)
   - Caixa de entrada reduzida para tamanho mÃ©dio (`w-96`)

3. **InteraÃ§Ãµes Melhoradas:**
   - **Fechar conversa:** Click no backdrop, botÃ£o X flutuante ou botÃ£o "Limpar"
   - **Voltar Ã s sugestÃµes:** Automaticamente ao fechar conversa
   - **Backdrop inteligente:** Escurece e desfoca o fundo para foco na conversa
   - **Mensagens expandidas:** Largura maior (480px) para melhor leitura
   - **Input otimizado:** Caixa de entrada em tamanho mÃ©dio, nÃ£o ocupa toda largura
   - **Efeitos visuais:** Semi-transparÃªncia e blur em todos os elementos

### âœ… Novo MÃ³dulo de OrÃ§amentos

**Data:** 16/01/2025  
**Objetivo:** Implementar mÃ³dulo de gestÃ£o do funil de vendas atravÃ©s de orÃ§amentos odontolÃ³gicos.

#### ğŸ¯ Funcionalidades Implementadas:

1. **PÃ¡gina de OrÃ§amentos**
   - Arquivo: `src/pages/OrcamentosPage.tsx`
   - Dashboard com KPIs: Total de orÃ§amentos, valor total, aprovados, taxa de conversÃ£o
   - Tabela com lista de orÃ§amentos e status visual (aguardando, aprovado, rejeitado, em negociaÃ§Ã£o)
   - Barra de probabilidade de conversÃ£o para cada orÃ§amento
   - Controles de busca e filtros

2. **IntegraÃ§Ã£o na Sidebar**
   - Arquivo: `src/components/Sidebar.tsx`
   - Adicionado "OrÃ§amentos" na seÃ§Ã£o **ğŸ‘©â€âš•ï¸ Atendimento**
   - Ãcone: FileText (lucide-react)
   - Rota: `/orcamentos`

3. **Roteamento**
   - Arquivo: `src/App.tsx`
   - Nova rota configurada para OrcamentosPage
   - IntegraÃ§Ã£o com React Router

4. **Funcionalidades da Interface:**
   - **KPIs visuais:** Cards com mÃ©tricas de performance do funil
   - **Status coloridos:** Indicadores visuais para cada status de orÃ§amento
   - **AÃ§Ãµes rÃ¡pidas:** BotÃµes para editar, aprovar e rejeitar orÃ§amentos
   - **Busca e filtros:** Ferramentas para gestÃ£o eficiente da lista
   - **Dados mockados:** Exemplos realistas de orÃ§amentos odontolÃ³gicos

### âœ… ReorganizaÃ§Ã£o da Sidebar por Jornadas de Trabalho

**Data:** 16/01/2025  
**Objetivo:** Separar ferramentas de atendimento das de gestÃ£o/backoffice para melhor organizaÃ§Ã£o do fluxo de trabalho.

#### ğŸ¯ Funcionalidades Implementadas:

1. **Nova Estrutura da Sidebar**
   - Arquivo: `src/components/Sidebar.tsx`
   - SeparaÃ§Ã£o em duas seÃ§Ãµes distintas: **Atendimento** e **GestÃ£o**
   - Mantido apenas o botÃ£o "Iniciar Nova Consulta" (sem adicionar Modo Consulta)
   - RenomeaÃ§Ã£o: "ComunicaÃ§Ã£o" â†’ "CRM"

2. **Novo MÃ³dulo ContÃ¡bil**
   - Arquivo: `src/pages/ContabilPage.tsx`
   - Dashboard com DAS, documentos pendentes e calendÃ¡rio de obrigaÃ§Ãµes
   - IntegraÃ§Ã£o com roteamento em `App.tsx`

3. **OrganizaÃ§Ã£o por Contexto de Uso:**
   - **ğŸ‘©â€âš•ï¸ Atendimento:** InÃ­cio, Agenda, Pacientes, OrÃ§amentos
   - **âš™ï¸ GestÃ£o:** Financeiro, Estoque, CRM, RelatÃ³rios, ContÃ¡bil

### âœ… ImplementaÃ§Ã£o de SugestÃµes Contextuais por MÃ³dulo

**Data:** 16/01/2025  
**Objetivo:** Implementar sugestÃµes de queries contextuais especÃ­ficas para cada mÃ³dulo, seguindo as diretrizes do PRD.

#### ğŸ¯ Funcionalidades Implementadas:

1. **Sistema Centralizado de SugestÃµes**
   - Arquivo: `src/data/contextualSuggestions.ts`
   - SugestÃµes especÃ­ficas para cada mÃ³dulo/pÃ¡gina
   - PriorizaÃ§Ã£o automÃ¡tica (alta, mÃ©dia, baixa)
   - CategorizaÃ§Ã£o por tipo (aÃ§Ã£o, pergunta, anÃ¡lise)

2. **ChatOverlay Aprimorado**
   - Arquivo: `src/components/ChatOverlay.tsx`
   - ExibiÃ§Ã£o de sugestÃµes contextuais acima da barra de chat
   - Ãcones e cores diferenciadas por categoria
   - IntegraÃ§Ã£o com sistema de prioridades

3. **PÃ¡ginas Completas Implementadas:**
   - `PacientesPage.tsx` - GestÃ£o de pacientes com dados mockados
   - `FinanceiroPage.tsx` - Dashboard financeiro com mÃ©tricas
   - `EstoquePage.tsx` - Controle de estoque com alertas
   - `ComunicacaoPage.tsx` - CRM e automaÃ§Ã£o de mensagens
   - `RelatoriosPage.tsx` - AnÃ¡lises e insights

### âœ… ImplementaÃ§Ã£o de AnimaÃ§Ãµes Leves para Novas Mensagens

**Data:** 16/01/2025  
**Objetivo:** Adicionar feedback visual suave para novas mensagens no chat, melhorando a experiÃªncia do usuÃ¡rio com animaÃ§Ãµes leves.

#### ğŸ¯ Funcionalidades Implementadas:

1. **AnimaÃ§Ã£o Fade-in + Slide-up**
   - Arquivos: `src/components/ChatOverlay.tsx`, `src/components/AIChatPanel.tsx`, `src/index.css`
   - AnimaÃ§Ã£o sutil de 0.4s com easing suave (`ease-out`)
   - Movimento vertical de 12px para cima com fade-in simultÃ¢neo
   - Aplicada tanto para mensagens do usuÃ¡rio quanto do assistente

2. **Sistema de Controle de AnimaÃ§Ã£o**
   - Estado `newMessageIds` para rastrear mensagens recÃ©m-criadas
   - `useEffect` com timer de 600ms para remover classes de animaÃ§Ã£o
   - Propriedade `isNew` adicionada ao tipo `Message`
   - AnimaÃ§Ã£o ativada apenas para mensagens novas

3. **ImplementaÃ§Ã£o CSS Customizada**
   - Keyframes `fade-slide-up` com transformaÃ§Ãµes suaves
   - Classe utilitÃ¡ria `.animate-fade-slide-up` para aplicaÃ§Ã£o
   - IntegraÃ§Ã£o com Tailwind CSS mantendo performance

4. **ExperiÃªncia do UsuÃ¡rio:**
   - **Feedback imediato:** UsuÃ¡rio vÃª sua mensagem aparecer suavemente
   - **Resposta da IA:** AnimaÃ§Ã£o indica quando nova resposta chega
   - **NÃ£o-intrusivo:** AnimaÃ§Ã£o leve que nÃ£o distrai da leitura
   - **ConsistÃªncia:** Mesmo comportamento em ambos os modos de chat (overlay e panel)

#### ğŸ¨ Detalhes TÃ©cnicos da AnimaÃ§Ã£o:

```css
@keyframes fade-slide-up {
  0% {
    opacity: 0;
    transform: translateY(12px);
  }
  100% {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fade-slide-up {
  animation: fade-slide-up 0.4s ease-out;
}
```

#### ğŸ”„ Fluxo da AnimaÃ§Ã£o:

```
UsuÃ¡rio envia mensagem
    â†“
Mensagem criada com isNew: true
    â†“
newMessageIds atualizado com ID da mensagem
    â†“
Classe 'animate-fade-slide-up' aplicada
    â†“
AnimaÃ§Ã£o executa por 400ms
    â†“
ApÃ³s 600ms, useEffect limpa newMessageIds
    â†“
Classe de animaÃ§Ã£o removida
```

### âœ… Sistema de Chat Conversacional na HomePage

**Data:** 16/01/2025  
**Objetivo:** Implementar sistema de conversaÃ§Ã£o com overlay flutuante e blur na pÃ¡gina inicial, mantendo conteÃºdo fixo e experiÃªncia similar ao ChatOverlay.

#### ğŸ¯ Funcionalidades Implementadas:

1. **Sistema de ConversaÃ§Ã£o com Overlay**
   - Arquivo: `src/pages/HomePage.tsx`
   - Estados de chat: `suggestions` (padrÃ£o) e `conversation`
   - Overlay flutuante com backdrop blur quando em conversaÃ§Ã£o
   - ConteÃºdo da pÃ¡gina permanece fixo (nÃ£o Ã© empurrado para baixo)

### âœ… Contagem de Tempo DinÃ¢mica nos Cards de Status

**Data:** 16/01/2025  
**Objetivo:** Implementar contagem de tempo real nos cards de pacientes para melhorar o acompanhamento do fluxo de atendimento.

#### ğŸ¯ Funcionalidades Implementadas:

1. **Tempo DinÃ¢mico para Check-in Realizado**
   - Arquivo: `src/pages/HomePage.tsx`
   - Para pacientes na clÃ­nica com check-in realizado: mostra tempo decorrido desde a chegada
   - FunÃ§Ã£o `calcularTempoDesdeCheckIn()` calcula minutos desde o check-in
   - Formato: "15 min na clÃ­nica", "1 min na clÃ­nica", "chegou agora"

2. **Tempo DinÃ¢mico para Consultas em Andamento**
   - Para consultas no consultÃ³rio: mostra tempo decorrido desde inÃ­cio da consulta
   - FunÃ§Ã£o `calcularTempoDesdeInicioConsulta()` calcula minutos desde o inÃ­cio
   - Formato: "45 min em andamento", "1 min em andamento", "iniciando"

3. **Sistema de AtualizaÃ§Ã£o AutomÃ¡tica**
   - `useEffect` com intervalo de 30 segundos para atualizaÃ§Ã£o dos tempos
   - Estados tipados com interfaces `PacienteNaClinica` e `ConsultaNoConsultorio`
   - Propriedades adicionadas: `checkInTime` e `consultaIniciada` (Date | null)

4. **IntegraÃ§Ã£o com Check-in**
   - FunÃ§Ã£o `handleCheckIn()` atualizada para registrar timestamp do check-in
   - Timestamp automÃ¡tico quando paciente faz check-in
   - TransiÃ§Ã£o automÃ¡tica de tempo estÃ¡tico para dinÃ¢mico

#### ğŸ”„ Fluxo do Sistema:

```
Paciente na clÃ­nica (sem check-in)
    â†“
Exibe tempo estÃ¡tico (ex: "5 min")
    â†“
UsuÃ¡rio clica "Check-in"
    â†“
checkInTime = new Date()
    â†“
Exibe tempo dinÃ¢mico: calcularTempoDesdeCheckIn()
    â†“
AtualizaÃ§Ã£o automÃ¡tica a cada 30s
```

#### ğŸ“Š BenefÃ­cios Implementados:

- **Monitoramento real:** Acompanhamento preciso do tempo de espera
- **GestÃ£o de fluxo:** IdentificaÃ§Ã£o de gargalos no atendimento
- **ExperiÃªncia do paciente:** Controle visual do tempo de permanÃªncia
- **AutomaÃ§Ã£o:** Sem necessidade de input manual de tempos

2. **AnimaÃ§Ãµes de Mensagens**
   - Mesma animaÃ§Ã£o `fade-slide-up` dos outros componentes
   - Controle de animaÃ§Ã£o com `newMessageIds` e `useEffect`
   - AnimaÃ§Ã£o aplicada tanto para mensagens do usuÃ¡rio quanto da IA
   - DuraÃ§Ã£o de 400ms with cleanup automÃ¡tico apÃ³s 600ms

3. **Interface com Overlay e Blur**
   - **Modo SugestÃµes:** Pills de aÃ§Ãµes e perguntas (estado padrÃ£o)
   - **Modo Conversa:** Overlay flutuante centralizado na tela
   - **Backdrop:** Escuro com blur (`bg-black bg-opacity-20 backdrop-blur-sm`)
   - **Mensagens:** Semi-transparentes com blur (`bg-white/95 backdrop-blur-sm`)

4. **Compatibilidade com Modais Generativos**
   - DetecÃ§Ã£o de palavras-chave (`agendar`, `cadastrar paciente`)
   - Prioridade para modais generativos sobre sistema de chat
   - MantÃ©m funcionalidade existente intacta

5. **ExperiÃªncia do UsuÃ¡rio:**
   - **Overlay centralizado:** 600px de largura, 70vh de altura mÃ¡xima
   - **Header flutuante:** TÃ­tulo da conversa + botÃ£o fechar
   - **Mensagens do usuÃ¡rio:** Estilo indigo semi-transparente, alinhadas Ã  direita
   - **Mensagens da IA:** Estilo branco semi-transparente, alinhadas Ã  esquerda
   - **Action cards:** BotÃµes clicÃ¡veis em mensagens da IA
   - **Click-to-close:** Clique no backdrop para fechar conversa

#### ğŸ¨ Layout do Overlay com Backdrop:

```
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â† Backdrop escuro + blur
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚ Mensagem user   â”‚â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚ Resposta da IA          â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚ [ğŸ“Š Action] [ğŸ‘¥ Card]   â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
```

#### ğŸ”„ Fluxo de InteraÃ§Ã£o na HomePage:

```
Estado inicial: Modo 'suggestions' com pills visÃ­veis
    â†“
UsuÃ¡rio digita mensagem
    â†“
Se mensagem = "agendar*" â†’ Modal Generativo de Agendamento
Se mensagem = "cadastrar paciente*" â†’ Modal Generativo de Paciente
SenÃ£o â†’ Overlay de Chat Conversacional
    â†“
Backdrop blur aparece + overlay centralizado
    â†“
Mensagem do usuÃ¡rio aparece com animaÃ§Ã£o
    â†“
ApÃ³s 1s: Resposta da IA com action cards
    â†“
UsuÃ¡rio pode: continuar conversa, clicar backdrop ou [X] para fechar
    â†“
Overlay desaparece + volta ao modo 'suggestions'
```

---

## ğŸ—ï¸ Estrutura da Sidebar

### OrganizaÃ§Ã£o por Jornadas de Trabalho

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ CAPIM                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ğŸ©º Iniciar Nova Consulta]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ‘©â€âš•ï¸ ATENDIMENTO                     â”‚
â”‚ â€¢ InÃ­cio                            â”‚
â”‚ â€¢ Agenda                            â”‚
â”‚ â€¢ Pacientes                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš™ï¸ GESTÃƒO                           â”‚
â”‚ â€¢ Financeiro                        â”‚
â”‚ â€¢ Estoque                           â”‚
â”‚ â€¢ CRM                               â”‚
â”‚ â€¢ RelatÃ³rios                        â”‚
â”‚ â€¢ ContÃ¡bil                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### BenefÃ­cios da Nova OrganizaÃ§Ã£o:

- **Clareza no Fluxo:** SeparaÃ§Ã£o entre atividades clÃ­nicas e administrativas
- **ReduÃ§Ã£o da Sobrecarga Cognitiva:** Agrupamento lÃ³gico por contexto de uso
- **PreparaÃ§Ã£o para IA:** Estrutura alinhada com os agentes definidos no MVP
- **EficiÃªncia Operacional:** Acesso rÃ¡pido Ã s ferramentas mais usadas em cada contexto

---

## ğŸ—ºï¸ Fluxos Principais

### 1. Fluxo de Chat com Overlay Bubble

```
Estado inicial: Pills de sugestÃ£o visÃ­veis
    â†“
UsuÃ¡rio digita mensagem ou clica em sugestÃ£o
    â†“
UsuÃ¡rio pressiona Enter ou clica em Send
    â†“
Pills desaparecem + Overlay bubble aparece (fixed position)
    â†“
IA responde apÃ³s 1s delay + Action cards aparecem
    â†“
UsuÃ¡rio pode: continuar conversa, clicar actions, ou fechar
    â†“
Fechar: click backdrop/X/Limpar â†’ volta ao estado inicial
```

### 2. Fluxo de SugestÃµes Contextuais

```
UsuÃ¡rio navega para um mÃ³dulo
    â†“
ChatOverlay detecta rota atual via useLocation
    â†“
getPrioritizedSuggestions() busca sugestÃµes especÃ­ficas
    â†“
Exibe atÃ© 3 sugestÃµes priorizadas acima da barra de chat
    â†“
UsuÃ¡rio clica em sugestÃ£o â†’ preenche campo de texto automaticamente
```

### 3. Mapeamento de SugestÃµes por MÃ³dulo

| MÃ³dulo | Qtd. SugestÃµes | Exemplos Principais |
|--------|---------------|-------------------|
| **Agenda** | 5 | "Remarque a consulta de Maria para prÃ³xima semana" |
| **Pacientes** | 5 | "Quem nÃ£o voltou desde abril?" |
| **Financeiro** | 5 | "Conciliar transaÃ§Ãµes bancÃ¡rias do dia" |
| **Estoque** | 5 | "Repor anestÃ©sicos - estoque baixo" |
| **CRM** | 5 | "Enviar WhatsApp para confirmar consultas de amanhÃ£" |
| **RelatÃ³rios** | 5 | "Explicar por que o faturamento caiu 15% este mÃªs" |
| **ContÃ¡bil** | 5 | "Gerar DAS de dezembro e lembrar vencimento" |

### 4. Sistema de PriorizaÃ§Ã£o

```typescript
priority: 'alta' | 'media' | 'baixa'
category: 'acao' | 'pergunta' | 'analise'
```

- **Prioridade Alta**: Exibida primeiro, aÃ§Ãµes crÃ­ticas do dia
- **Prioridade MÃ©dia**: Tarefas importantes mas nÃ£o urgentes  
- **Prioridade Baixa**: AÃ§Ãµes de otimizaÃ§Ã£o e melhoria

---

## ğŸ¨ UI/UX Patterns

### CÃ³digo Visual das Categorias:

- **ğŸŸ¢ AÃ§Ãµes** (`bg-green-100 text-green-700`) + Ã­cone Zap
- **ğŸ”µ Perguntas** (`bg-blue-100 text-blue-700`) + Ã­cone MessageCircle  
- **ğŸŸ£ AnÃ¡lises** (`bg-purple-100 text-purple-700`) + Ã­cone BarChart3

### Layout do ChatOverlay (Estado Inicial):

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SugestÃµes para [MÃ³dulo]:                            â”‚
â”‚ [ğŸŸ¢ AÃ§Ã£o 1] [ğŸ”µ Pergunta 1] [ğŸŸ£ AnÃ¡lise 1]          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Contexto: [MÃ³dulo] â”‚ [Input Field] â”‚ [Send Button]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Layout do Overlay com Backdrop (Estado Conversa):

```
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  â† Backdrop escuro + blur
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚ Mensagem user   â”‚â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚ Resposta da IA          â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â”‚ [ğŸ“Š Action] [ğŸ‘¥ Card]   â”‚â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â–‘â–‘â–‘â–‘â–‘â–‘â–‘
â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘
```

#### ğŸ”§ Detalhes TÃ©cnicos:

- **Z-index hierarchy:** Input/buttons (z-50) > Overlay messages (z-40) > Backdrop (z-40)
- **Positioning:** Container ajustado para Ã¡rea sem sidebar (`left-64 right-0`)
- **CentralizaÃ§Ã£o:** Flex justify-center no container principal
- **Padding:** `pt-8` no container para espaÃ§amento superior
- **Responsividade:** Max-height 70vh com scroll automÃ¡tico
- **Click-to-close:** Apenas clique no backdrop (sem botÃ£o X)

---

## ğŸ”§ Arquitetura TÃ©cnica

### Componentes Modificados:

1. **`ChatOverlay.tsx`**
   - Adicionado import de sugestÃµes contextuais
   - Implementado sistema de priorizaÃ§Ã£o visual
   - IntegraÃ§Ã£o com useLocation para detecÃ§Ã£o de contexto

2. **`contextualSuggestions.ts`**
   - Sistema centralizado de sugestÃµes
   - FunÃ§Ãµes utilitÃ¡rias para busca e priorizaÃ§Ã£o
   - Mapeamento completo por rota

3. **PÃ¡ginas Implementadas:**
   - Todas as pÃ¡ginas agora tÃªm dados mockados realistas
   - UI consistente com cards de mÃ©tricas
   - IntegraÃ§Ã£o com ChatOverlay

### Dependency Tree:

```
App.tsx
â”œâ”€â”€ Layout.tsx
â”‚   â”œâ”€â”€ Sidebar.tsx
â”‚   â”œâ”€â”€ [PageComponents]
â”‚   â””â”€â”€ ChatOverlay.tsx
â”‚       â””â”€â”€ contextualSuggestions.ts
â””â”€â”€ pages/
    â”œâ”€â”€ HomePage.tsx
    â”œâ”€â”€ AgendaPage.tsx (jÃ¡ existente)
    â”œâ”€â”€ PacientesPage.tsx (novo)
    â”œâ”€â”€ FinanceiroPage.tsx (novo)
    â”œâ”€â”€ EstoquePage.tsx (novo)
    â”œâ”€â”€ ComunicacaoPage.tsx (novo)
    â””â”€â”€ RelatoriosPage.tsx (novo)
```

---

## ğŸš€ Como Testar

1. **Executar o projeto:**
   ```bash
   cd projetos/saas_agentico/capim-ai-demo
   npm run dev
   ```

2. **Testar sugestÃµes contextuais:**
   - Navegar para cada mÃ³dulo (Agenda, Pacientes, Financeiro, etc.)
   - Verificar se as sugestÃµes especÃ­ficas aparecem no ChatOverlay
   - Clicar nas sugestÃµes para preencher o campo de texto

3. **Verificar priorizaÃ§Ã£o:**
   - SugestÃµes de alta prioridade devem aparecer primeiro
   - Cores e Ã­cones devem estar corretos por categoria

---

## ğŸ“ PrÃ³ximas Melhorias Sugeridas

1. **SugestÃµes DinÃ¢micas:** Basear sugestÃµes no contexto atual da tela (ex: se hÃ¡ paciente selecionado)
2. **HistÃ³rico de SugestÃµes:** LembranÃ§a das sugestÃµes mais utilizadas por usuÃ¡rio
3. **A/B Testing:** Testar diferentes formatos de sugestÃµes
4. **IntegraÃ§Ã£o com IA:** Gerar sugestÃµes baseadas em padrÃµes de uso

---

## ğŸ› Issues Conhecidos

- âœ… Erro de import do tipo `ContextualSuggestion` - **Resolvido** com type-only import
- âœ… Conflito entre placeholders e componentes reais - **Resolvido** removendo placeholders
- âš ï¸ SugestÃµes ainda nÃ£o sÃ£o funcionais (apenas preenchem o campo de texto)

---

## ğŸ“Š MÃ©tricas de ImplementaÃ§Ã£o

- **Linhas de cÃ³digo adicionadas:** ~800 linhas
- **Novos arquivos criados:** 6 (5 pÃ¡ginas + 1 arquivo de dados)
- **Componentes modificados:** 2 (ChatOverlay + App)
- **Tempo de implementaÃ§Ã£o:** ~2 horas
- **Cobertura de mÃ³dulos:** 100% (todos os 6 mÃ³dulos implementados)

---

*Documento atualizado automaticamente apÃ³s cada mudanÃ§a significativa no sistema.* 